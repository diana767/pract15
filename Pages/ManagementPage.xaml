<Page x:Class="Pract15.Pages.ManagementPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      xmlns:local="clr-namespace:Pract15.Pages"
      Title="Управление"
      Background="{StaticResource PrimaryBackgroundBrush}">

    <Page.Resources>
        <Style x:Key="DataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="RowBackground" Value="Transparent"/>
            <Setter Property="AlternatingRowBackground" Value="#F5F5F5"/>
            <Setter Property="ColumnHeaderHeight" Value="40"/>
            <Setter Property="RowHeight" Value="35"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="CanUserReorderColumns" Value="False"/>
            <Setter Property="CanUserResizeColumns" Value="True"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
            <Setter Property="CanUserSortColumns" Value="True"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
        </Style>

        <Style x:Key="ActionButton" TargetType="Button" BasedOn="{StaticResource MaterialDesignFlatButton}">
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Width" Value="80"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
    </Page.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Border Grid.Row="0" 
                Background="{StaticResource PrimaryBrush}"
                Padding="20"
                CornerRadius="8"
                Margin="0,0,0,20">
            <TextBlock Text="Управление магазином"
                       FontSize="24"
                       FontWeight="Bold"
                       Foreground="White"
                       HorizontalAlignment="Center"/>
        </Border>
        <TabControl Grid.Row="1">
            <TabItem Header="Товары">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Добавить товар"
                                Click="AddProduct_Click"
                                Style="{StaticResource PrimaryButton}"
                                Margin="0,0,10,0"/>
                        <Button Content="Обновить"
                                Click="RefreshProducts_Click"
                                Style="{StaticResource SecondaryButton}"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" 
                              x:Name="ProductsGrid"
                              Style="{StaticResource DataGridStyle}"
                              ItemsSource="{Binding Products}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Название" Binding="{Binding Name}" Width="200"/>
                            <DataGridTextColumn Header="Цена" Binding="{Binding Price, StringFormat={}{0:C}}" Width="100"/>
                            <DataGridTextColumn Header="Остаток" Binding="{Binding Stock}" Width="80"/>
                            <DataGridTextColumn Header="Категория" Binding="{Binding Category.Name}" Width="120"/>
                            <DataGridTextColumn Header="Бренд" Binding="{Binding Brand.Name}" Width="120"/>
                            <DataGridTemplateColumn Header="Действия" Width="160">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="Ред."
                                                    Tag="{Binding Id}"
                                                    Click="EditProduct_Click"
                                                    Style="{StaticResource ActionButton}"
                                                    Background="{StaticResource PrimaryBrush}"
                                                    Foreground="White"/>
                                            <Button Content="Уд."
                                                    Tag="{Binding Id}"
                                                    Click="DeleteProduct_Click"
                                                    Style="{StaticResource ActionButton}"
                                                    Background="{StaticResource ErrorBrush}"
                                                    Foreground="White"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Категории">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Добавить"
                                Click="AddCategory_Click"
                                Style="{StaticResource PrimaryButton}"
                                Margin="0,0,10,0"/>
                        <Button Content="Обновить"
                                Click="RefreshCategories_Click"
                                Style="{StaticResource SecondaryButton}"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" 
                              x:Name="CategoriesGrid"
                              Style="{StaticResource DataGridStyle}"
                              ItemsSource="{Binding Categories}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Название" Binding="{Binding Name}" Width="*"/>
                            <DataGridTemplateColumn Header="Действия" Width="160">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="Ред."
                                                    Tag="{Binding Id}"
                                                    Click="EditCategory_Click"
                                                    Style="{StaticResource ActionButton}"
                                                    Background="{StaticResource PrimaryBrush}"
                                                    Foreground="White"/>
                                            <Button Content="Уд."
                                                    Tag="{Binding Id}"
                                                    Click="DeleteCategory_Click"
                                                    Style="{StaticResource ActionButton}"
                                                    Background="{StaticResource ErrorBrush}"
                                                    Foreground="White"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
            <TabItem Header="Бренды">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Добавить"
                                Click="AddBrand_Click"
                                Style="{StaticResource PrimaryButton}"
                                Margin="0,0,10,0"/>
                        <Button Content="Обновить"
                                Click="RefreshBrands_Click"
                                Style="{StaticResource SecondaryButton}"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" 
                              x:Name="BrandsGrid"
                              Style="{StaticResource DataGridStyle}"
                              ItemsSource="{Binding Brands}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Название" Binding="{Binding Name}" Width="*"/>
                            <DataGridTemplateColumn Header="Действия" Width="160">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="Ред."
                                                    Tag="{Binding Id}"
                                                    Click="EditBrand_Click"
                                                    Style="{StaticResource ActionButton}"
                                                    Background="{StaticResource PrimaryBrush}"
                                                    Foreground="White"/>
                                            <Button Content="Уд."
                                                    Tag="{Binding Id}"
                                                    Click="DeleteBrand_Click"
                                                    Style="{StaticResource ActionButton}"
                                                    Background="{StaticResource ErrorBrush}"
                                                    Foreground="White"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
            <TabItem Header="Теги">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="Добавить"
                                Click="AddTag_Click"
                                Style="{StaticResource PrimaryButton}"
                                Margin="0,0,10,0"/>
                        <Button Content="Обновить"
                                Click="RefreshTags_Click"
                                Style="{StaticResource SecondaryButton}"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" 
                              x:Name="TagsGrid"
                              Style="{StaticResource DataGridStyle}"
                              ItemsSource="{Binding Tags}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                            <DataGridTextColumn Header="Название" Binding="{Binding Name}" Width="*"/>
                            <DataGridTemplateColumn Header="Действия" Width="160">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="Ред."
                                                    Tag="{Binding Id}"
                                                    Click="EditTag_Click"
                                                    Style="{StaticResource ActionButton}"
                                                    Background="{StaticResource PrimaryBrush}"
                                                    Foreground="White"/>
                                            <Button Content="Уд."
                                                    Tag="{Binding Id}"
                                                    Click="DeleteTag_Click"
                                                    Style="{StaticResource ActionButton}"
                                                    Background="{StaticResource ErrorBrush}"
                                                    Foreground="White"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>

        <Button Grid.Row="2"
                Content="Вернуться к товарам"
                Style="{StaticResource PrimaryButton}"
                HorizontalAlignment="Center"
                Margin="0,20,0,0"
                Click="Back_Click"/>
    </Grid>
</Page>